<!DOCTYPE html>
<html lang="fa" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SEO Optimizer</title>
    <style>
      @font-face {
        font-family: "IRANYekan";
        src: url(IRANYekanRegular.ttf);
        font-weight: normal;
        font-style: normal;
        font-display: swap;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .iphone-container {
        max-width: 900px;
        width: 100%;
        background: #0a0a0a;
        border-radius: 50px;
        padding: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      }

      .screen {
        background: linear-gradient(135deg, #1a5f4a 0%, #0a0a0a 100%);
        border-radius: 35px;
        padding: 30px 20px;
        min-height: 800px;
        position: relative;
        overflow-y: auto;
        max-height: 90vh;
      }

      .screen::-webkit-scrollbar {
        width: 12px;
      }

      .screen::-webkit-scrollbar-track {
        background: rgba(26, 95, 74, 0.2);
        border-radius: 10px;
        margin: 10px;
      }

      .screen::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #2ecc71, #27ae60);
        border-radius: 10px;
        border: 2px solid rgba(26, 95, 74, 0.3);
        transition: all 0.3s ease;
      }

      .screen::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #27ae60, #1e8449);
        border-color: #2ecc71;
        box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
      }

      .screen::-webkit-scrollbar-thumb:active {
        background: linear-gradient(180deg, #1e8449, #196f3d);
      }

      body.light-theme .screen::-webkit-scrollbar-track {
        background: rgba(255, 255, 255, 0.3);
      }

      body.light-theme .screen::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #00897b, #00695c);
        border-color: rgba(255, 255, 255, 0.4);
      }

      body.light-theme .screen::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #00695c, #004d40);
        box-shadow: 0 0 10px rgba(0, 137, 123, 0.5);
      }

      .header {
        text-align: center;
        margin-bottom: 30px;
      }

      .header h1 {
        color: #f5f5f5;
        font-size: 32px;
        font-weight: 700;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .theme-switch {
        position: absolute;
        top: 20px;
        left: 20px;
        width: 50px;
        height: 50px;
        background: rgba(26, 95, 74, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
      }

      .theme-switch:hover {
        background: rgba(26, 95, 74, 0.6);
        transform: scale(1.1);
      }

      .theme-switch svg {
        width: 24px;
        height: 24px;
        fill: #f5f5f5;
        transition: transform 0.5s ease;
      }

      body.light-theme {
        background: linear-gradient(135deg, #e0f2f1 0%, #b2dfdb 100%);
      }

      body.light-theme .iphone-container {
        background: #ffffff;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
      }

      body.light-theme .screen {
        background: linear-gradient(135deg, #26a69a 0%, #00897b 100%);
      }

      body.light-theme .liquid-glass {
        background: rgba(255, 255, 255, 0.25);
        border: 1px solid rgba(255, 255, 255, 0.4);
      }

      body.light-theme textarea,
      body.light-theme .result-card {
        color: #ffffff;
      }

      body.light-theme .btn-analyze {
        background: #00897b;
      }

      body.light-theme .btn-analyze:hover {
        background: #00695c;
      }

      body.light-theme .theme-switch {
        background: rgba(255, 255, 255, 0.3);
      }

      body.light-theme .theme-switch:hover {
        background: rgba(255, 255, 255, 0.5);
      }

      .liquid-glass {
        backdrop-filter: blur(10px);
        background: rgba(26, 95, 74, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        transition: all 0.3s ease;
      }

      .input-section {
        margin-bottom: 20px;
      }

      textarea {
        width: 100%;
        min-height: 150px;
        padding: 15px;
        font-size: 16px;
        color: #f5f5f5;
        border: none;
        outline: none;
        resize: vertical;
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: transparent;
      }

      textarea::placeholder {
        color: rgba(245, 245, 245, 0.5);
      }

      .btn-analyze {
        width: 100%;
        padding: 15px;
        background: #2ecc71;
        color: white;
        border: none;
        border-radius: 15px;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 20px;
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .btn-analyze:hover {
        background: #27ae60;
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(46, 204, 113, 0.3);
      }

      .btn-analyze:active {
        transform: translateY(0);
      }

      .results-container {
        display: none;
        animation: fadeIn 0.5s ease;
      }

      .results-container.show {
        display: block;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .result-card {
        padding: 15px;
        margin-bottom: 15px;
        color: #f5f5f5;
        animation: slideIn 0.3s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .result-card h3 {
        font-size: 14px;
        margin-bottom: 8px;
        color: rgba(245, 245, 245, 0.7);
      }

      .result-card p {
        font-size: 16px;
        line-height: 1.6;
      }

      .score-card {
        text-align: center;
        padding: 20px;
        margin-top: 20px;
      }

      .score-value {
        font-size: 48px;
        font-weight: 700;
        margin: 10px 0;
      }

      .score-excellent {
        color: #2ecc71;
      }

      .score-good {
        color: #f39c12;
      }

      .score-poor {
        color: #e74c3c;
      }

      .btn-clear {
        width: 100%;
        padding: 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.3);
        color: #f5f5f5;
        border-radius: 15px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 15px;
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .btn-clear:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      .keywords-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      .keyword-tag {
        background: rgba(46, 204, 113, 0.3);
        border: 1px solid rgba(46, 204, 113, 0.5);
        padding: 6px 12px;
        border-radius: 15px;
        font-size: 14px;
        color: #2ecc71;
      }

      .tabs-container {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        overflow-x: auto;
      }

      .tab-btn {
        padding: 10px 20px;
        background: rgba(26, 95, 74, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #f5f5f5;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s ease;
        white-space: nowrap;
        font-size: 14px;
        backdrop-filter: blur(10px);
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .tab-btn.active {
        background: #2ecc71;
        border-color: #2ecc71;
      }

      .tab-btn:hover {
        background: rgba(46, 204, 113, 0.4);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .action-buttons {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-top: 15px;
      }

      .btn-action {
        padding: 10px;
        background: rgba(26, 95, 74, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #f5f5f5;
        border-radius: 12px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .btn-action:hover {
        background: rgba(26, 95, 74, 0.6);
        transform: translateY(-2px);
      }

      .progress-bar {
        width: 100%;
        height: 20px;
        background: rgba(26, 95, 74, 0.3);
        border-radius: 10px;
        overflow: hidden;
        margin: 15px 0;
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #2ecc71, #27ae60);
        transition: width 0.5s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 600;
      }

      .stat-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-bottom: 15px;
      }

      .stat-card {
        padding: 15px;
        text-align: center;
      }

      .stat-value {
        font-size: 24px;
        font-weight: 700;
        margin: 5px 0;
      }

      .stat-label {
        font-size: 12px;
        color: rgba(245, 245, 245, 0.7);
      }

      .readability-indicator {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 13px;
        font-weight: 600;
        margin-right: 8px;
      }

      .readability-easy {
        background: rgba(46, 204, 113, 0.3);
        color: #2ecc71;
      }

      .readability-medium {
        background: rgba(243, 156, 18, 0.3);
        color: #f39c12;
      }

      .readability-hard {
        background: rgba(231, 76, 60, 0.3);
        color: #e74c3c;
      }

      .density-indicator {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        font-size: 13px;
        margin-top: 5px;
      }

      .density-bar {
        width: 60px;
        height: 8px;
        background: rgba(26, 95, 74, 0.3);
        border-radius: 4px;
        overflow: hidden;
      }

      .density-fill {
        height: 100%;
        transition: width 0.3s ease;
      }

      .suggestion-card {
        background: rgba(46, 204, 113, 0.15);
        border: 1px solid rgba(46, 204, 113, 0.3);
        border-radius: 15px;
        padding: 15px;
        margin-bottom: 10px;
      }

      .suggestion-card h4 {
        color: #2ecc71;
        margin-bottom: 8px;
        font-size: 14px;
      }

      .suggestion-card p {
        font-size: 13px;
        line-height: 1.6;
      }

      .copy-btn {
        background: rgba(46, 204, 113, 0.3);
        border: 1px solid rgba(46, 204, 113, 0.5);
        color: #2ecc71;
        padding: 6px 12px;
        border-radius: 8px;
        font-size: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 10px;
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .copy-btn:hover {
        background: rgba(46, 204, 113, 0.5);
      }

      .comparison-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      .comparison-table th,
      .comparison-table td {
        padding: 12px;
        text-align: right;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .comparison-table th {
        font-weight: 600;
        color: #2ecc71;
      }

      .file-input-label {
        display: inline-block;
        padding: 12px 20px;
        background: rgba(26, 95, 74, 0.4);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(10px);
        color: #f5f5f5;
        font-size: 14px;
        text-align: center;
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .file-input-label:hover {
        background: rgba(26, 95, 74, 0.6);
      }

      input[type="file"] {
        display: none;
      }

      .language-badge {
        display: inline-block;
        padding: 4px 10px;
        background: rgba(0, 212, 255, 0.3);
        border: 1px solid rgba(0, 212, 255, 0.5);
        border-radius: 10px;
        font-size: 12px;
        color: #00d4ff;
        margin-right: 8px;
      }

      .chart-container {
        margin: 20px 0;
        padding: 20px;
        min-height: 300px;
      }

      .chart-canvas {
        max-width: 100%;
        height: 250px;
      }

      .word-cloud {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        align-items: center;
        padding: 20px;
        min-height: 200px;
      }

      .word-cloud-item {
        padding: 8px 16px;
        border-radius: 15px;
        background: rgba(46, 204, 113, 0.2);
        border: 1px solid rgba(46, 204, 113, 0.4);
        color: #2ecc71;
        font-weight: 600;
        transition: all 0.3s ease;
        cursor: pointer;
        animation: float 3s ease-in-out infinite;
      }

      .word-cloud-item:hover {
        transform: scale(1.1);
        background: rgba(46, 204, 113, 0.4);
      }

      @keyframes float {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-10px);
        }
      }

      .export-section {
        margin-top: 20px;
      }

      .btn-export {
        width: 100%;
        padding: 12px;
        background: rgba(46, 204, 113, 0.3);
        border: 1px solid rgba(46, 204, 113, 0.5);
        color: #2ecc71;
        border-radius: 12px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 10px;
        font-family: "Vazir", "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      .btn-export:hover {
        background: rgba(46, 204, 113, 0.5);
        transform: translateY(-2px);
      }

      .sentiment-badge {
        display: inline-block;
        padding: 6px 14px;
        border-radius: 12px;
        font-size: 13px;
        font-weight: 600;
        margin: 5px;
      }

      .sentiment-positive {
        background: rgba(46, 204, 113, 0.3);
        color: #2ecc71;
        border: 1px solid rgba(46, 204, 113, 0.5);
      }

      .sentiment-negative {
        background: rgba(231, 76, 60, 0.3);
        color: #e74c3c;
        border: 1px solid rgba(231, 76, 60, 0.5);
      }

      .sentiment-neutral {
        background: rgba(243, 156, 18, 0.3);
        color: #f39c12;
        border: 1px solid rgba(243, 156, 18, 0.5);
      }

      .progress-ring {
        width: 120px;
        height: 120px;
        margin: 0 auto;
      }

      .progress-ring-circle {
        transition: stroke-dashoffset 0.5s ease;
        transform: rotate(-90deg);
        transform-origin: 50% 50%;
      }

      .hashtag-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      .hashtag-item {
        background: rgba(0, 212, 255, 0.2);
        border: 1px solid rgba(0, 212, 255, 0.4);
        padding: 6px 12px;
        border-radius: 15px;
        font-size: 13px;
        color: #00d4ff;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .hashtag-item:hover {
        background: rgba(0, 212, 255, 0.4);
        transform: scale(1.05);
      }

      @media (max-width: 768px) {
        .iphone-container {
          max-width: 100%;
          border-radius: 30px;
          padding: 15px;
        }

        .screen {
          border-radius: 20px;
          padding: 20px 15px;
        }
      }

      @media (max-width: 480px) {
        .stat-grid {
          grid-template-columns: 1fr;
        }

        .action-buttons {
          grid-template-columns: 1fr;
        }

        .tabs-container {
          flex-wrap: nowrap;
          overflow-x: auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="iphone-container">
      <div class="screen">
        <button class="theme-switch" onclick="toggleTheme()" title="ØªØºÛŒÛŒØ± ØªÙ…">
          <svg id="theme-icon-sun" viewBox="0 0 24 24" style="display: none">
            <circle cx="12" cy="12" r="5" />
            <line x1="12" y1="1" x2="12" y2="3" />
            <line x1="12" y1="21" x2="12" y2="23" />
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
            <line x1="1" y1="12" x2="3" y2="12" />
            <line x1="21" y1="12" x2="23" y2="12" />
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
          </svg>
          <svg id="theme-icon-moon" viewBox="0 0 24 24">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
          </svg>
        </button>

        <div class="header">
          <h1>SEO Optimizer Pro</h1>
        </div>

        <div class="tabs-container">
          <button class="tab-btn active" onclick="switchTab('analyze')">
            ğŸ“Š ØªØ­Ù„ÛŒÙ„
          </button>
          <button class="tab-btn" onclick="switchTab('visual')">
            ğŸ“ˆ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
          </button>
          <button class="tab-btn" onclick="switchTab('compare')">
            âš–ï¸ Ù…Ù‚Ø§ÛŒØ³Ù‡
          </button>
          <button class="tab-btn" onclick="switchTab('history')">
            ğŸ“œ ØªØ§Ø±ÛŒØ®Ú†Ù‡
          </button>
          <button class="tab-btn" onclick="switchTab('export')">
            ğŸ“¥ ØµØ§Ø¯Ø±Ø§Øª
          </button>
        </div>

        <div id="analyzeTab" class="tab-content active">
          <div class="action-buttons" style="margin-bottom: 15px">
            <label class="file-input-label" for="fileInput">
              ğŸ“ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙØ§ÛŒÙ„
              <input
                type="file"
                id="fileInput"
                accept=".txt"
                onchange="loadFile(event)"
              />
            </label>
            <button class="btn-action" onclick="loadSampleText()">
              ğŸ“ Ù…ØªÙ† Ù†Ù…ÙˆÙ†Ù‡
            </button>
          </div>

          <div class="input-section liquid-glass">
            <textarea
              id="textInput"
              placeholder="Ù…ØªÙ† Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
            ></textarea>
          </div>

          <button class="btn-analyze" onclick="analyzeSEO()">
            ğŸ” ØªØ¬Ø²ÛŒÙ‡ Ùˆ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ SEO
          </button>

          <div id="results" class="results-container"></div>
        </div>

        <div id="compareTab" class="tab-content">
          <div class="input-section liquid-glass" style="margin-bottom: 15px">
            <textarea
              id="textInput1"
              placeholder="Ù…ØªÙ† Ø§ÙˆÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
              style="min-height: 100px"
            ></textarea>
          </div>
          <div class="input-section liquid-glass" style="margin-bottom: 15px">
            <textarea
              id="textInput2"
              placeholder="Ù…ØªÙ† Ø¯ÙˆÙ… Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."
              style="min-height: 100px"
            ></textarea>
          </div>
          <button class="btn-analyze" onclick="compareTexts()">
            âš–ï¸ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù…ØªÙ†â€ŒÙ‡Ø§
          </button>
          <div id="compareResults" class="results-container"></div>
        </div>

        <div id="visualTab" class="tab-content">
          <div class="result-card liquid-glass">
            <h3 style="text-align: center; margin-bottom: 15px">
              â˜ï¸ Ø§Ø¨Ø± Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ
            </h3>
            <div id="wordCloud" class="word-cloud">
              <p style="text-align: center; color: rgba(245, 245, 245, 0.7)">
                Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯
              </p>
            </div>
          </div>

          <div class="result-card liquid-glass chart-container">
            <h3 style="text-align: center; margin-bottom: 15px">
              ğŸ“Š Ù†Ù…ÙˆØ¯Ø§Ø± ØªØ±Ø§Ú©Ù… Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ
            </h3>
            <canvas id="densityChart" class="chart-canvas"></canvas>
          </div>

          <div class="result-card liquid-glass">
            <h3 style="text-align: center; margin-bottom: 15px">
              ğŸ¯ Ù¾ÛŒØ´Ø±ÙØª Ø§Ù…ØªÛŒØ§Ø² SEO
            </h3>
            <div style="text-align: center">
              <svg class="progress-ring">
                <circle
                  class="progress-ring-circle"
                  stroke="#2ecc71"
                  stroke-width="8"
                  fill="transparent"
                  r="52"
                  cx="60"
                  cy="60"
                />
                <text
                  id="scoreText"
                  x="50%"
                  y="50%"
                  text-anchor="middle"
                  dy=".3em"
                  fill="#f5f5f5"
                  font-size="24"
                  font-weight="bold"
                >
                  0
                </text>
              </svg>
            </div>
          </div>

          <div class="result-card liquid-glass">
            <h3 style="text-align: center; margin-bottom: 15px">
              #ï¸âƒ£ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù‡Ø´ØªÚ¯
            </h3>
            <div id="hashtagList" class="hashtag-list">
              <p
                style="
                  text-align: center;
                  color: rgba(245, 245, 245, 0.7);
                  width: 100%;
                "
              >
                Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯
              </p>
            </div>
          </div>
        </div>

        <div id="historyTab" class="tab-content">
          <div id="historyList" class="results-container">
            <div class="result-card liquid-glass">
              <p style="text-align: center; color: rgba(245, 245, 245, 0.7)">
                Ù‡Ù†ÙˆØ² ØªØ­Ù„ÛŒÙ„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª
              </p>
            </div>
          </div>
        </div>

        <div id="exportTab" class="tab-content">
          <div class="result-card liquid-glass export-section">
            <h3 style="text-align: center; margin-bottom: 20px">
              ğŸ“¥ ØµØ§Ø¯Ø±Ø§Øª Ù†ØªØ§ÛŒØ¬
            </h3>

            <button class="btn-export" onclick="exportToPDF()">
              ğŸ“„ Ø¯Ø§Ù†Ù„ÙˆØ¯ PDF
            </button>

            <button class="btn-export" onclick="exportToJSON()">
              ğŸ“‹ Ø¯Ø§Ù†Ù„ÙˆØ¯ JSON
            </button>

            <button class="btn-export" onclick="exportToCSV()">
              ğŸ“Š Ø¯Ø§Ù†Ù„ÙˆØ¯ CSV
            </button>

            <button class="btn-export" onclick="copyAllResults()">
              ğŸ“‹ Ú©Ù¾ÛŒ Ù‡Ù…Ù‡ Ù†ØªØ§ÛŒØ¬
            </button>

            <div
              id="exportMessage"
              style="
                text-align: center;
                margin-top: 15px;
                color: #2ecc71;
                display: none;
              "
            >
              âœ“ Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!
            </div>
          </div>
        </div>

        <button
          class="btn-clear"
          onclick="clearAll()"
          style="display: none"
          id="clearBtn"
        >
          ğŸ—‘ï¸ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù†
        </button>
      </div>
    </div>

    <script>
      const stopwords = [
        "Ø¯Ø±",
        "Ø¨Ù‡",
        "Ø§Ø²",
        "Ú©Ù‡",
        "Ùˆ",
        "Ø¨Ø§",
        "Ø¨Ø±Ø§ÛŒ",
        "Ø§ÛŒÙ†",
        "Ø¢Ù†",
        "Ø§Ø³Øª",
        "Ø±Ø§",
        "ØªØ§",
        "Ù‡Ø±",
        "ÛŒØ§",
        "Ø¨Ø±",
        "Ø§Ùˆ",
        "Ù…Ø§",
        "Ø´Ù…Ø§",
        "Ø¢Ù†Ù‡Ø§",
        "Ù…Ù†",
        "ØªÙˆ",
        "Ù‡Ø§ÛŒ",
        "Ø´ÙˆØ¯",
        "Ù…ÛŒ",
        "Ø¨Ø§Ø´Ø¯",
        "ÛŒÚ©",
        "Ù‡Ù…",
        "Ú©Ø±Ø¯",
        "Ø®ÙˆØ¯",
        "Ú¯ÙØª",
        "Ø´Ø¯",
        "Ø¯Ø§Ø±Ø¯",
        "Ø¨ÙˆØ¯",
        "Ú©Ù†Ø¯",
      ];

      const stopwordsEn = [
        "the",
        "is",
        "at",
        "which",
        "on",
        "a",
        "an",
        "as",
        "are",
        "was",
        "were",
        "been",
        "be",
        "have",
        "has",
        "had",
        "do",
        "does",
        "did",
        "will",
        "would",
        "should",
        "could",
        "may",
        "might",
        "must",
        "can",
        "of",
        "for",
        "to",
        "in",
        "and",
        "or",
        "but",
        "not",
        "this",
        "that",
        "with",
        "from",
        "by",
      ];

      function switchTab(tabName) {
        document
          .querySelectorAll(".tab-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document
          .querySelectorAll(".tab-content")
          .forEach((content) => content.classList.remove("active"));

        event.target.classList.add("active");
        document.getElementById(tabName + "Tab").classList.add("active");
      }

      function detectLanguage(text) {
        const persianPattern = /[\u0600-\u06FF]/;
        const isPersian = persianPattern.test(text);
        return isPersian ? "fa" : "en";
      }

      function loadFile(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function (e) {
            document.getElementById("textInput").value = e.target.result;
          };
          reader.readAsText(file);
        }
      }

      function loadSampleText() {
        const sampleText =
          "Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÙˆØªÙˆØ±Ù‡Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ ÛŒØ§ Ø³Ø¦Ùˆ ÛŒÚ©ÛŒ Ø§Ø² Ù…Ù‡Ù…â€ŒØªØ±ÛŒÙ† ØªÚ©Ù†ÛŒÚ©â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø§Ø³Øª. Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø³Ø¦Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ ÙˆØ¨â€ŒØ³Ø§ÛŒØª Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø± Ù†ØªØ§ÛŒØ¬ Ø¬Ø³ØªØ¬ÙˆÛŒ Ú¯ÙˆÚ¯Ù„ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ù‡ÛŒØ¯. Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ù…Ù†Ø§Ø³Ø¨ØŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø¨Ø§Ú©ÛŒÙÛŒØª Ùˆ Ø³Ø§Ø®ØªØ§Ø± ØµØ­ÛŒØ­ ÙˆØ¨â€ŒØ³Ø§ÛŒØª Ø§Ø² Ø¹ÙˆØ§Ù…Ù„ Ù…Ù‡Ù… Ø¯Ø± Ø³Ø¦Ùˆ Ù‡Ø³ØªÙ†Ø¯. Ù‡Ù…Ú†Ù†ÛŒÙ† Ø³Ø±Ø¹Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø³Ø§ÛŒØª Ùˆ ØªØ¬Ø±Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø±ÛŒ Ù†ÛŒØ² ØªØ§Ø«ÛŒØ± Ø²ÛŒØ§Ø¯ÛŒ Ø¯Ø± Ø±ØªØ¨Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ø§Ø±Ù†Ø¯.";
        document.getElementById("textInput").value = sampleText;
      }

      function calculateReadability(text, wordCount) {
        const sentences = text
          .split(/[.!?]+/)
          .filter((s) => s.trim().length > 0);
        const sentenceCount = sentences.length || 1;
        const avgWordsPerSentence = wordCount / sentenceCount;

        let level, className;
        if (avgWordsPerSentence <= 15) {
          level = "Ø³Ø§Ø¯Ù‡";
          className = "readability-easy";
        } else if (avgWordsPerSentence <= 25) {
          level = "Ù…ØªÙˆØ³Ø·";
          className = "readability-medium";
        } else {
          level = "Ù¾ÛŒÚ†ÛŒØ¯Ù‡";
          className = "readability-hard";
        }

        return {
          level,
          className,
          avgWordsPerSentence: avgWordsPerSentence.toFixed(1),
          sentenceCount,
        };
      }

      function calculateKeywordDensity(keywords, totalWords) {
        return keywords.map((kw) => {
          const density = ((kw[1] / totalWords) * 100).toFixed(2);
          let status = "Ù…Ù†Ø§Ø³Ø¨";
          let color = "#2ecc71";

          if (density < 1) {
            status = "Ú©Ù…";
            color = "#f39c12";
          } else if (density > 3) {
            status = "Ø²ÛŒØ§Ø¯";
            color = "#e74c3c";
          }

          return { ...kw, density, status, color };
        });
      }

      function generateSuggestions(
        score,
        wordCount,
        readability,
        keywordDensities
      ) {
        const suggestions = [];

        if (wordCount < 300) {
          suggestions.push({
            title: "ğŸ“ Ø§ÙØ²Ø§ÛŒØ´ Ø·ÙˆÙ„ Ù…Ø­ØªÙˆØ§",
            text: "Ù…Ø­ØªÙˆØ§ÛŒ Ø´Ù…Ø§ Ú©ÙˆØªØ§Ù‡ Ø§Ø³Øª. Ø¨Ø±Ø§ÛŒ SEO Ø¨Ù‡ØªØ±ØŒ Ø­Ø¯Ø§Ù‚Ù„ 300 Ú©Ù„Ù…Ù‡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯.",
          });
        }

        if (readability.level === "Ù¾ÛŒÚ†ÛŒØ¯Ù‡") {
          suggestions.push({
            title: "ğŸ“– Ø³Ø§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø¬Ù…Ù„Ø§Øª",
            text: "Ø¬Ù…Ù„Ø§Øª Ø´Ù…Ø§ Ø¨Ù„Ù†Ø¯ Ù‡Ø³ØªÙ†Ø¯. Ø³Ø¹ÛŒ Ú©Ù†ÛŒØ¯ Ø¬Ù…Ù„Ø§Øª Ú©ÙˆØªØ§Ù‡â€ŒØªØ± Ùˆ Ø³Ø§Ø¯Ù‡â€ŒØªØ± Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯.",
          });
        }

        const lowDensity = keywordDensities.filter((k) => k.density < 1);
        if (lowDensity.length > 0) {
          suggestions.push({
            title: "ğŸ”‘ Ø§ÙØ²Ø§ÛŒØ´ Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ",
            text: "Ø¨Ø±Ø®ÛŒ Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ ØªØ±Ø§Ú©Ù… Ù¾Ø§ÛŒÛŒÙ†ÛŒ Ø¯Ø§Ø±Ù†Ø¯. Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø¨ÛŒØ´ØªØ± Ø¯Ø± Ù…ØªÙ† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.",
          });
        }

        if (score < 70) {
          suggestions.push({
            title: "â­ Ø¨Ù‡Ø¨ÙˆØ¯ Ú©Ù„ÛŒ SEO",
            text: "Ø¨Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒØŒ ØªØµØ§ÙˆÛŒØ± Ø¨Ø§ alt text Ùˆ Ù‡Ø¯ÛŒÙ†Ú¯â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø§Ø³Ø¨ØŒ Ø§Ù…ØªÛŒØ§Ø² Ø±Ø§ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¯Ù‡ÛŒØ¯.",
          });
        }

        return suggestions;
      }

      function saveToHistory(data) {
        let history = JSON.parse(localStorage.getItem("seoHistory") || "[]");
        history.unshift({
          ...data,
          date: new Date().toLocaleString("fa-IR"),
          id: Date.now(),
        });
        history = history.slice(0, 10);
        localStorage.setItem("seoHistory", JSON.stringify(history));
      }

      function loadHistory() {
        const history = JSON.parse(localStorage.getItem("seoHistory") || "[]");
        const historyList = document.getElementById("historyList");

        if (history.length === 0) {
          historyList.innerHTML =
            '<div class="result-card liquid-glass"><p style="text-align: center; color: rgba(245, 245, 245, 0.7);">Ù‡Ù†ÙˆØ² ØªØ­Ù„ÛŒÙ„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</p></div>';
          return;
        }

        historyList.innerHTML = history
          .map(
            (item) => `
                <div class="result-card liquid-glass">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <span style="font-size: 12px; color: rgba(245, 245, 245, 0.6);">${
                          item.date
                        }</span>
                        <span class="score-value ${
                          item.scoreClass
                        }" style="font-size: 20px;">${item.score}/100</span>
                    </div>
                    <p style="font-size: 14px;">${item.text.substring(
                      0,
                      100
                    )}...</p>
                    <div style="margin-top: 10px;">
                        <span style="font-size: 12px; color: rgba(245, 245, 245, 0.7);">Ú©Ù„Ù…Ø§Øª: ${
                          item.wordCount
                        } | Ú©Ø§Ø±Ø§Ú©ØªØ±: ${item.charCount}</span>
                    </div>
                </div>
            `
          )
          .join("");
      }

      function copyToClipboard(text, button) {
        navigator.clipboard.writeText(text).then(() => {
          const originalText = button.innerHTML;
          button.innerHTML = "âœ“ Ú©Ù¾ÛŒ Ø´Ø¯";
          setTimeout(() => {
            button.innerHTML = originalText;
          }, 2000);
        });
      }

      function downloadJSON(data) {
        const blob = new Blob([JSON.stringify(data, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `seo-analysis-${Date.now()}.json`;
        a.click();
      }

      function toggleTheme() {
        document.body.classList.toggle("light-theme");
        const sunIcon = document.getElementById("theme-icon-sun");
        const moonIcon = document.getElementById("theme-icon-moon");

        if (document.body.classList.contains("light-theme")) {
          sunIcon.style.display = "block";
          moonIcon.style.display = "none";
          localStorage.setItem("theme", "light");
        } else {
          sunIcon.style.display = "none";
          moonIcon.style.display = "block";
          localStorage.setItem("theme", "dark");
        }
      }

      window.addEventListener("DOMContentLoaded", () => {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "light") {
          document.body.classList.add("light-theme");
          document.getElementById("theme-icon-sun").style.display = "block";
          document.getElementById("theme-icon-moon").style.display = "none";
        }
      });

      function analyzeSEO() {
        const text = document.getElementById("textInput").value.trim();

        if (!text) {
          alert("âš ï¸ Ù„Ø·ÙØ§Ù‹ Ø§Ø¨ØªØ¯Ø§ Ù…ØªÙ†ÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!");
          return;
        }

        const language = detectLanguage(text);
        const currentStopwords = language === "fa" ? stopwords : stopwordsEn;
        const languageLabel = language === "fa" ? "ÙØ§Ø±Ø³ÛŒ" : "English";

        const words = text.split(/\s+/);
        const wordCount = words.length;
        const charCount = text.length;
        const uniqueWords = new Set(words.map((w) => w.toLowerCase())).size;

        const cleanWords = words.map((w) =>
          w.replace(/[.,!?;:()[\]{}""']/g, "").toLowerCase()
        );
        const filteredWords = cleanWords.filter(
          (w) => w.length > 3 && !currentStopwords.includes(w)
        );

        const wordFreq = {};
        filteredWords.forEach((word) => {
          wordFreq[word] = (wordFreq[word] || 0) + 1;
        });

        const topKeywords = Object.entries(wordFreq)
          .sort((a, b) => b[1] - a[1])
          .slice(0, 5);

        let seoTitle =
          topKeywords.length > 0
            ? topKeywords
                .slice(0, 3)
                .map((kw) => kw[0])
                .join(" - ")
            : text.substring(0, 60);

        if (seoTitle.length > 60) {
          seoTitle = seoTitle.substring(0, 57) + "...";
        } else if (seoTitle.length < 50) {
          seoTitle = text.substring(0, 50) + "...";
        }

        const metaDesc =
          text.length > 160 ? text.substring(0, 157) + "..." : text;

        let score = 0;
        if (wordCount >= 300 && wordCount <= 2000) score += 30;
        else if (wordCount > 100) score += 15;

        if (seoTitle.length >= 50 && seoTitle.length <= 60) score += 25;
        else if (seoTitle.length >= 40 && seoTitle.length <= 70) score += 15;

        if (metaDesc.length >= 155 && metaDesc.length <= 160) score += 25;
        else if (metaDesc.length >= 140 && metaDesc.length <= 170) score += 15;

        if (topKeywords.length >= 3) score += 20;
        else if (topKeywords.length >= 1) score += 10;

        const readability = calculateReadability(text, wordCount);
        const keywordDensities = calculateKeywordDensity(
          topKeywords,
          wordCount
        );
        const suggestions = generateSuggestions(
          score,
          wordCount,
          readability,
          keywordDensities
        );

        const analysisData = {
          text,
          wordCount,
          charCount,
          uniqueWords,
          keywords: topKeywords,
          title: seoTitle,
          desc: metaDesc,
          score,
          language: languageLabel,
          readability,
          scoreClass:
            score >= 70
              ? "score-excellent"
              : score >= 40
              ? "score-good"
              : "score-poor",
        };

        saveToHistory(analysisData);
        displayResults(analysisData, keywordDensities, suggestions);
      }

      let currentAnalysisData = null;

      function displayResults(data, keywordDensities, suggestions) {
        currentAnalysisData = data;
        const resultsDiv = document.getElementById("results");
        const clearBtn = document.getElementById("clearBtn");

        let scoreClass =
          data.score >= 70
            ? "score-excellent"
            : data.score >= 40
            ? "score-good"
            : "score-poor";
        let scoreLabel =
          data.score >= 70
            ? "Ø¹Ø§Ù„ÛŒ"
            : data.score >= 40
            ? "Ø®ÙˆØ¨"
            : "Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø¨Ù‡Ø¨ÙˆØ¯";

        let html = `
                <div class="stat-grid">
                    <div class="stat-card liquid-glass">
                        <div class="stat-value">${data.wordCount}</div>
                        <div class="stat-label">ğŸ“Š Ú©Ù„Ù…Ø§Øª</div>
                    </div>
                    <div class="stat-card liquid-glass">
                        <div class="stat-value">${data.charCount}</div>
                        <div class="stat-label">ğŸ“ Ú©Ø§Ø±Ø§Ú©ØªØ±</div>
                    </div>
                    <div class="stat-card liquid-glass">
                        <div class="stat-value">${data.uniqueWords}</div>
                        <div class="stat-label">ğŸ”¤ Ú©Ù„Ù…Ø§Øª Ù…Ù†Ø­ØµØ±</div>
                    </div>
                    <div class="stat-card liquid-glass">
                        <div class="stat-value">${data.readability.sentenceCount}</div>
                        <div class="stat-label">ğŸ“„ Ø¬Ù…Ù„Ø§Øª</div>
                    </div>
                </div>

                <div class="result-card liquid-glass">
                    <h3>ğŸŒ Ø²Ø¨Ø§Ù† Ù…ØªÙ†</h3>
                    <p><span class="language-badge">${data.language}</span></p>
                </div>

                <div class="result-card liquid-glass">
                    <h3>ğŸ“– Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ Ù…ØªÙ†</h3>
                    <p>
                        <span class="readability-indicator ${data.readability.className}">${data.readability.level}</span>
                        Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† ${data.readability.avgWordsPerSentence} Ú©Ù„Ù…Ù‡ Ø¯Ø± Ù‡Ø± Ø¬Ù…Ù„Ù‡
                    </p>
                </div>
            `;

        if (data.keywords.length > 0) {
          html += `
                    <div class="result-card liquid-glass">
                        <h3>ğŸ”‘ Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ Ø¨Ø±ØªØ±</h3>
                        <div class="keywords-list">
                            ${data.keywords
                              .map(
                                (kw) =>
                                  `<span class="keyword-tag">${kw[0]} (${kw[1]})</span>`
                              )
                              .join("")}
                        </div>
                    </div>
                `;
        }

        if (keywordDensities.length > 0) {
          html += `
                    <div class="result-card liquid-glass">
                        <h3>ğŸ” ØªØ±Ø§Ú©Ù… Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ</h3>
                `;
          keywordDensities.forEach((kw) => {
            html += `
                        <div style="margin: 10px 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span>${kw[0]}</span>
                                <span class="density-indicator">
                                    <span>${kw.density}%</span>
                                    <span style="color: ${kw.color};">${
              kw.status
            }</span>
                                </span>
                            </div>
                            <div class="density-bar">
                                <div class="density-fill" style="width: ${Math.min(
                                  kw.density * 33,
                                  100
                                )}%; background: ${kw.color};"></div>
                            </div>
                        </div>
                    `;
          });
          html += `</div>`;
        }

        html += `
                <div class="result-card liquid-glass">
                    <h3>ğŸ“Œ Ø¹Ù†ÙˆØ§Ù† Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ SEO</h3>
                    <p>${data.title}</p>
                    <button class="copy-btn" onclick="copyToClipboard('${data.title.replace(
                      /'/g,
                      "\\'"
                    )}', this)">ğŸ“‹ Ú©Ù¾ÛŒ Ø¹Ù†ÙˆØ§Ù†</button>
                </div>
                <div class="result-card liquid-glass">
                    <h3>ğŸ“„ ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…ØªØ§ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ</h3>
                    <p>${data.desc}</p>
                    <button class="copy-btn" onclick="copyToClipboard('${data.desc.replace(
                      /'/g,
                      "\\'"
                    )}', this)">ğŸ“‹ Ú©Ù¾ÛŒ ØªÙˆØ¶ÛŒØ­Ø§Øª</button>
                </div>

                <div class="score-card liquid-glass">
                    <h3>â­ Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ SEO</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${
                          data.score
                        }%; ${
          data.score < 40
            ? "background: #e74c3c;"
            : data.score < 70
            ? "background: #f39c12;"
            : ""
        }">
                            ${data.score}%
                        </div>
                    </div>
                    <div class="score-value ${scoreClass}">${
          data.score
        }/100</div>
                    <p>${scoreLabel}</p>
                </div>
            `;

        if (suggestions.length > 0) {
          html += `<div class="result-card liquid-glass"><h3>ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ø¨Ù‡Ø¨ÙˆØ¯</h3>`;
          suggestions.forEach((sug) => {
            html += `
                        <div class="suggestion-card">
                            <h4>${sug.title}</h4>
                            <p>${sug.text}</p>
                        </div>
                    `;
          });
          html += `</div>`;
        }

        resultsDiv.innerHTML = html;
        resultsDiv.classList.add("show");
        clearBtn.style.display = "block";

        updateVisualizations(data, keywordDensities);
      }

      function updateVisualizations(data, keywordDensities) {
        updateWordCloud(data.keywords);
        updateProgressRing(data.score);
        updateHashtags(data.keywords);
        updateDensityChart(keywordDensities);
      }

      function updateWordCloud(keywords) {
        const wordCloud = document.getElementById("wordCloud");
        if (keywords.length === 0) {
          wordCloud.innerHTML =
            '<p style="text-align: center; color: rgba(245, 245, 245, 0.7);">Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>';
          return;
        }

        const maxFreq = keywords[0][1];
        wordCloud.innerHTML = keywords
          .map((kw, i) => {
            const size = 12 + (kw[1] / maxFreq) * 20;
            const delay = i * 0.3;
            return `<div class="word-cloud-item" style="font-size: ${size}px; animation-delay: ${delay}s;">${kw[0]}</div>`;
          })
          .join("");
      }

      function updateProgressRing(score) {
        const circle = document.querySelector(".progress-ring-circle");
        const text = document.getElementById("scoreText");
        const circumference = 2 * Math.PI * 52;

        circle.style.strokeDasharray = `${circumference} ${circumference}`;
        const offset = circumference - (score / 100) * circumference;

        setTimeout(() => {
          circle.style.strokeDashoffset = offset;
          text.textContent = score;
        }, 100);
      }

      function updateHashtags(keywords) {
        const hashtagList = document.getElementById("hashtagList");
        if (keywords.length === 0) {
          hashtagList.innerHTML =
            '<p style="text-align: center; color: rgba(245, 245, 245, 0.7); width: 100%;">Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯</p>';
          return;
        }

        hashtagList.innerHTML = keywords
          .slice(0, 5)
          .map(
            (kw) =>
              `<div class="hashtag-item" onclick="copyToClipboard('#${kw[0]}', this)">#${kw[0]}</div>`
          )
          .join("");
      }

      function updateDensityChart(keywordDensities) {
        const canvas = document.getElementById("densityChart");
        const ctx = canvas.getContext("2d");

        canvas.width = canvas.offsetWidth;
        canvas.height = 250;

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        if (keywordDensities.length === 0) return;

        const barWidth = canvas.width / keywordDensities.length - 20;
        const maxDensity = Math.max(
          ...keywordDensities.map((k) => parseFloat(k.density))
        );

        keywordDensities.forEach((kw, i) => {
          const height = (parseFloat(kw.density) / maxDensity) * 180;
          const x = i * (barWidth + 20) + 20;
          const y = canvas.height - height - 40;

          ctx.fillStyle = kw.color;
          ctx.fillRect(x, y, barWidth, height);

          ctx.fillStyle = "#f5f5f5";
          ctx.font = "12px Vazir, Segoe UI";
          ctx.textAlign = "center";
          ctx.fillText(kw[0], x + barWidth / 2, canvas.height - 25);
          ctx.fillText(kw.density + "%", x + barWidth / 2, y - 5);
        });
      }

      function compareTexts() {
        const text1 = document.getElementById("textInput1").value.trim();
        const text2 = document.getElementById("textInput2").value.trim();

        if (!text1 || !text2) {
          alert("âš ï¸ Ù„Ø·ÙØ§Ù‹ Ù‡Ø± Ø¯Ùˆ Ù…ØªÙ† Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯!");
          return;
        }

        const analyze = (text) => {
          const words = text.split(/\s+/);
          const wordCount = words.length;
          const charCount = text.length;
          const sentences = text
            .split(/[.!?]+/)
            .filter((s) => s.trim().length > 0).length;
          return {
            wordCount,
            charCount,
            sentences,
            avgWords: (wordCount / sentences).toFixed(1),
          };
        };

        const data1 = analyze(text1);
        const data2 = analyze(text2);

        const compareResults = document.getElementById("compareResults");
        compareResults.innerHTML = `
                <div class="result-card liquid-glass">
                    <h3 style="text-align: center; margin-bottom: 20px;">âš–ï¸ Ù†ØªØ§ÛŒØ¬ Ù…Ù‚Ø§ÛŒØ³Ù‡</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>Ù…Ø¹ÛŒØ§Ø±</th>
                                <th>Ù…ØªÙ† Ø§ÙˆÙ„</th>
                                <th>Ù…ØªÙ† Ø¯ÙˆÙ…</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª</td>
                                <td>${data1.wordCount}</td>
                                <td>${data2.wordCount}</td>
                            </tr>
                            <tr>
                                <td>ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø§Ú©ØªØ±</td>
                                <td>${data1.charCount}</td>
                                <td>${data2.charCount}</td>
                            </tr>
                            <tr>
                                <td>ØªØ¹Ø¯Ø§Ø¯ Ø¬Ù…Ù„Ø§Øª</td>
                                <td>${data1.sentences}</td>
                                <td>${data2.sentences}</td>
                            </tr>
                            <tr>
                                <td>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ú©Ù„Ù…Ø§Øª/Ø¬Ù…Ù„Ù‡</td>
                                <td>${data1.avgWords}</td>
                                <td>${data2.avgWords}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            `;
        compareResults.classList.add("show");
      }

      function exportToPDF() {
        if (!currentAnalysisData) {
          alert("âš ï¸ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯!");
          return;
        }

        const content = `
SEO Analysis Report
==================

ØªØ§Ø±ÛŒØ®: ${new Date().toLocaleString("fa-IR")}

Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ:
- ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª: ${currentAnalysisData.wordCount}
- ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø§Ú©ØªØ±: ${currentAnalysisData.charCount}
- Ø§Ù…ØªÛŒØ§Ø² SEO: ${currentAnalysisData.score}/100

Ø¹Ù†ÙˆØ§Ù† Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:
${currentAnalysisData.title}

ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…ØªØ§:
${currentAnalysisData.desc}

Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ:
${currentAnalysisData.keywords.map((k) => `- ${k[0]} (${k[1]} Ø¨Ø§Ø±)`).join("\n")}
            `;

        const blob = new Blob([content], { type: "text/plain" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `seo-report-${Date.now()}.txt`;
        a.click();
        showExportMessage();
      }

      function exportToJSON() {
        if (!currentAnalysisData) {
          alert("âš ï¸ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯!");
          return;
        }
        downloadJSON(currentAnalysisData);
        showExportMessage();
      }

      function exportToCSV() {
        if (!currentAnalysisData) {
          alert("âš ï¸ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯!");
          return;
        }

        const csv = `Ù…Ø¹ÛŒØ§Ø±,Ù…Ù‚Ø¯Ø§Ø±
ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª,${currentAnalysisData.wordCount}
ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø§Ú©ØªØ±,${currentAnalysisData.charCount}
Ø§Ù…ØªÛŒØ§Ø² SEO,${currentAnalysisData.score}
Ø²Ø¨Ø§Ù†,${currentAnalysisData.language}
Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ,${currentAnalysisData.readability.level}
`;

        const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `seo-data-${Date.now()}.csv`;
        a.click();
        showExportMessage();
      }

      function copyAllResults() {
        if (!currentAnalysisData) {
          alert("âš ï¸ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯!");
          return;
        }

        const text = `
Ø§Ù…ØªÛŒØ§Ø² SEO: ${currentAnalysisData.score}/100
ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„Ù…Ø§Øª: ${currentAnalysisData.wordCount}
ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø§Ú©ØªØ±: ${currentAnalysisData.charCount}
Ø²Ø¨Ø§Ù†: ${currentAnalysisData.language}

Ø¹Ù†ÙˆØ§Ù† Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ:
${currentAnalysisData.title}

ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…ØªØ§:
${currentAnalysisData.desc}

Ú©Ù„Ù…Ø§Øª Ú©Ù„ÛŒØ¯ÛŒ:
${currentAnalysisData.keywords.map((k) => `${k[0]} (${k[1]})`).join(", ")}
            `;

        navigator.clipboard.writeText(text).then(() => {
          showExportMessage();
        });
      }

      function showExportMessage() {
        const msg = document.getElementById("exportMessage");
        msg.style.display = "block";
        setTimeout(() => {
          msg.style.display = "none";
        }, 3000);
      }

      function clearAll() {
        document.getElementById("textInput").value = "";
        document.getElementById("results").innerHTML = "";
        document.getElementById("results").classList.remove("show");
        document.getElementById("clearBtn").style.display = "none";
        currentAnalysisData = null;

        document.getElementById("wordCloud").innerHTML =
          '<p style="text-align: center; color: rgba(245, 245, 245, 0.7);">Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯</p>';
        document.getElementById("hashtagList").innerHTML =
          '<p style="text-align: center; color: rgba(245, 245, 245, 0.7); width: 100%;">Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© Ù…ØªÙ† Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯</p>';
        document.getElementById("scoreText").textContent = "0";
      }
    </script>
  </body>
</html>
